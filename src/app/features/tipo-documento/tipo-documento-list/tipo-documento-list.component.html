<div class="tipo-documento-container">
  <!-- Header -->
  <div class="header">
    <h2>Gesti√≥n de Tipos de Documento</h2>
    <div class="header-buttons">
      <button class="btn btn-primary" (click)="createTipoDocumento()">
        <span>+</span> Nuevo Tipo de Documento
      </button>
      <button class="back-btn" (click)="onCancel()">
        ‚Üê Volver al listado
      </button>
    </div>
  </div>

  <!-- Filtros y b√∫squeda -->
  <div class="filters">
    <div class="filter-group">
      <label for="estado">Estado:</label>
      <select id="estado" [(ngModel)]="selectedEstado" (change)="onEstadoChange()" class="form-select">
        <option *ngFor="let option of estadoOptions" [value]="option.value">
          {{ option.label }}
        </option>
      </select>
    </div>

    <div class="filter-group">
      <label for="search">Buscar:</label>
      <input 
        type="text" 
        id="search" 
        [(ngModel)]="searchTerm" 
        (input)="onSearchChange()" 
        placeholder="Buscar por nombre..."
        class="form-input"
      >
    </div>

    <div class="filter-group">
      <label for="pageSize">Elementos por p√°gina:</label>
      <select id="pageSize" [(ngModel)]="pageSize" (ngModelChange)="onPageSizeChange($event)" class="form-select">
        <option [value]="5">5</option>
        <option [value]="10">10</option>
        <option [value]="25">25</option>
        <option [value]="50">50</option>
      </select>
    </div>
  </div>

  <!-- Contenedor principal con async pipe -->
  <div *ngIf="tiposDocumento$ | async as tiposResponse; else loadingTemplate" class="table-container">
    
    <table class="tipo-documento-table" *ngIf="tiposResponse.content.length > 0">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Estado</th>
          <th>Fecha Creaci√≥n</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let tipoDocumento of tiposResponse.content; trackBy: trackByTipoDocumento" class="tipo-documento-row">
          <td class="tipo-documento-name">{{ tipoDocumento.nombre }}</td>
          <td>
            <span class="status-badge" [ngClass]="getEstadoClass(tipoDocumento.activo)">
              {{ tipoDocumento.activo ? 'Activo' : 'Inactivo' }}
            </span>
          </td>
          <td>{{ tipoDocumento.fecCreacion | date:'dd/MM/yyyy' }}</td>
          <td class="actions">
            <button class="btn btn-sm btn-info" (click)="viewTipoDocumento(tipoDocumento.idTipoDocumento!)" title="Ver detalles">
              üëÅÔ∏è
            </button>
            <button class="btn btn-sm btn-warning" (click)="editTipoDocumento(tipoDocumento.idTipoDocumento!)" title="Editar">
              ‚úèÔ∏è
            </button>
            <button class="btn btn-sm" [ngClass]="tipoDocumento.activo ? 'btn-danger' : 'btn-success'"
              (click)="toggleEstado(tipoDocumento)" [title]="tipoDocumento.activo ? 'Desactivar' : 'Activar'">
              {{ tipoDocumento.activo ? 'üîí' : 'üîì' }}
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="tiposResponse.content.length === 0" class="empty-state">
      <h3>No hay tipos de documento disponibles</h3>
      <p>No se encontraron tipos de documento con los filtros seleccionados.</p>
      <button class="btn btn-primary" (click)="createTipoDocumento()">
        Crear primer tipo de documento
      </button>
    </div>

    <!-- Paginaci√≥n -->
    <div class="pagination" *ngIf="tiposResponse.totalPages > 1">
      <button class="btn btn-outline" [disabled]="currentPage === 0" (click)="onPageChange(0)">
        ‚èÆ
      </button>

      <button class="btn btn-outline" [disabled]="currentPage === 0" (click)="onPageChange(currentPage - 1)">
        ‚¨ÖÔ∏è
      </button>

      <button *ngFor="let page of getPaginationRange(tiposResponse.totalPages)" class="btn"
        [ngClass]="page === currentPage ? 'btn-primary' : 'btn-outline'" (click)="onPageChange(page)">
        {{ page + 1 }}
      </button>

      <button class="btn btn-outline" [disabled]="currentPage === tiposResponse.totalPages - 1" 
        (click)="onPageChange(currentPage + 1)">
        ‚û°Ô∏è
      </button>

      <button class="btn btn-outline" [disabled]="currentPage === tiposResponse.totalPages - 1" 
        (click)="onPageChange(tiposResponse.totalPages - 1)">
        ‚è≠
      </button>
    </div>

    <div class="pagination-info">
      Mostrando {{ tiposResponse.content.length }} de {{ tiposResponse.totalElements }} elementos
    </div>
  </div>

  <!-- Template de loading -->
  <ng-template #loadingTemplate>
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Cargando tipos de documento...</p>
    </div>
  </ng-template>
</div>
