<div class="cargo-container">
  <!-- Header -->
  <div class="header">
    <h2>Gesti√≥n de Cargos</h2>
    <div class="header-buttons">
      <button class="btn btn-primary" (click)="createCargo()">
        <span>+</span> Nuevo Cargo
      </button>
      <button class="back-btn" (click)="onCancel()">
        ‚Üê Volver al listado
      </button>
    </div>
  </div>

  <!-- Filtros y b√∫squeda -->
  <div class="filters">
    <div class="filter-group">
      <label for="estado">Estado:</label>
      <select id="estado" [(ngModel)]="selectedEstado" (change)="onEstadoChange()" class="form-select">
        <option *ngFor="let option of estadoOptions" [value]="option.value">
          {{ option.label }}
        </option>
      </select>
    </div>

    <div class="filter-group">
      <label for="search">Buscar:</label>
      <input 
        type="text" 
        id="search" 
        [(ngModel)]="searchTerm" 
        (input)="onSearchChange()" 
        placeholder="Buscar por nombre..."
        class="form-input"
      >
    </div>

    <div class="filter-group">
      <label for="pageSize">Elementos por p√°gina:</label>
      <select id="pageSize" [(ngModel)]="pageSize" (ngModelChange)="onPageSizeChange($event)" class="form-select">
        <option [value]="5">5</option>
        <option [value]="10">10</option>
        <option [value]="25">25</option>
        <option [value]="50">50</option>
      </select>
    </div>
  </div>

  <!-- Contenedor principal con async pipe -->
  <div *ngIf="cargos$ | async as cargosResponse; else loadingTemplate" class="table-container">
    
    <table class="cargo-table" *ngIf="cargosResponse.content.length > 0">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Estado</th>
          <th>Fecha Creaci√≥n</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cargo of cargosResponse.content; trackBy: trackByCargo" class="cargo-row">
          <td class="cargo-name">{{ cargo.nombre }}</td>
          <td>
            <span class="status-badge" [ngClass]="getEstadoClass(cargo.activo)">
              {{ cargo.activo ? 'Activo' : 'Inactivo' }}
            </span>
          </td>
          <td>{{ cargo.fecCreacion | date:'dd/MM/yyyy' }}</td>
          <td class="actions">
            <button class="btn btn-sm btn-info" (click)="viewCargo(cargo.idCargo!)" title="Ver detalles">
              üëÅÔ∏è
            </button>
            <button class="btn btn-sm btn-warning" (click)="editCargo(cargo.idCargo!)" title="Editar">
              ‚úèÔ∏è
            </button>
            <button class="btn btn-sm" [ngClass]="cargo.activo ? 'btn-danger' : 'btn-success'"
              (click)="toggleEstado(cargo)" [title]="cargo.activo ? 'Desactivar' : 'Activar'">
              {{ cargo.activo ? 'üîí' : 'üîì' }}
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="cargosResponse.content.length === 0" class="empty-state">
      <h3>No hay cargos disponibles</h3>
      <p>No se encontraron cargos con los filtros seleccionados.</p>
      <button class="btn btn-primary" (click)="createCargo()">
        Crear primer cargo
      </button>
    </div>

    <!-- Paginaci√≥n -->
    <div class="pagination" *ngIf="cargosResponse.totalPages > 1">
      <button class="btn btn-outline" [disabled]="currentPage === 0" (click)="onPageChange(0)">
        ‚Æ®
      </button>

      <button class="btn btn-outline" [disabled]="currentPage === 0" (click)="onPageChange(currentPage - 1)">
        ‚¨ÖÔ∏è
      </button>

      <button *ngFor="let page of getPaginationRange(cargosResponse.totalPages)" class="btn"
        [ngClass]="page === currentPage ? 'btn-primary' : 'btn-outline'" (click)="onPageChange(page)">
        {{ page + 1 }}
      </button>

      <button class="btn btn-outline" [disabled]="currentPage === cargosResponse.totalPages - 1" 
        (click)="onPageChange(currentPage + 1)">
        ‚û°Ô∏è
      </button>

      <button class="btn btn-outline" [disabled]="currentPage === cargosResponse.totalPages - 1" 
        (click)="onPageChange(cargosResponse.totalPages - 1)">
       ‚û•
      </button>
    </div>

    <div class="pagination-info">
      Mostrando {{ cargosResponse.content.length }} de {{ cargosResponse.totalElements }} elementos
    </div>
  </div>

  <!-- Template de loading -->
  <ng-template #loadingTemplate>
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Cargando cargos...</p>
    </div>
  </ng-template>
</div>